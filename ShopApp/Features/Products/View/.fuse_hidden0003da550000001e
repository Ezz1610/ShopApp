//
//  File.swift
//  ShopApp
//
//  Created by mohamed ezz on 25/10/2025.
//

import Foundation
import SwiftUI

struct ProductDetailsView: View {
    let product: ProductModel
    @EnvironmentObject var navigator: AppNavigator

    var body: some View {
        ScrollView {
            VStack(alignment: .leading, spacing: 16) {
                TabView {
                    ForEach(product.images) { img in
                        CustomNetworkImage(url: img.src, width: UIScreen.main.bounds.width, height: 300, cornerRadius: 0)
                            .frame(maxWidth: .infinity, maxHeight: 300)
                    }
                }
                .tabViewStyle(PageTabViewStyle())
                .frame(height: 300)

                Text(product.title)
                    .font(.title2.bold())
                    .padding(.horizontal)

                if let price = product.variants.first?.price {
                    Text("$\(price)")
                        .font(.title3.bold())
                        .foregroundColor(.accentColor)
                        .padding(.horizontal)
                }

                Text(product.bodyHTML)
                    .font(.body)
                    .padding(.horizontal)

                // Options example placeholder
                if !product.options.isEmpty {
                    VStack(alignment: .leading, spacing: 8) {
                        ForEach(product.options) { option in
                            Text(option.name)
                                .font(.headline)
                            ScrollView(.horizontal, showsIndicators: false) {
                                HStack {
                                    ForEach(option.values, id: \.self) { value in
                                        Text(value)
                                            .padding(.vertical, 6)
                                            .padding(.horizontal, 12)
                                            .background(Color(.secondarySystemBackground))
                                            .cornerRadius(8)
                                    }
                                }
                            }
                        }
                    }
                    .padding(.horizontal)
                }

                Button(action: {
                    // add to cart
                }) {
                    Text("Add to Cart")
                        .frame(maxWidth: .infinity)
                        .padding()
                        .background(Color.accentColor)
                        .foregroundColor(.white)
                        .cornerRadius(12)
                }
                .padding()
            }
        }
        .navigationTitle("Details")
        .navigationBarTitleDisplayMode(.inline)
    }
}
